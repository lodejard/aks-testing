{
    "type": "Microsoft.Compute/virtualMachines/extensions",
    "copy": {
        "count": "EXTENSION_LOOP_COUNT",
        "name": "monitoringExtensionLoop"
    },
    "apiVersion": "[variables('apiVersionCompute')]",
    "dependsOn": [
        "[concat('Microsoft.Compute/virtualMachines/', EXTENSION_TARGET_VM_NAME_PREFIX, copyIndex(EXTENSION_LOOP_OFFSET))]"
    ],
    "location": "[variables('location')]",
    "name": "[concat(EXTENSION_TARGET_VM_NAME_PREFIX, copyIndex(EXTENSION_LOOP_OFFSET), '/Microsoft.EnterpriseCloud.Monitoring')]",
    "properties": {
        "autoUpgradeMinorVersion": true,
        "settings": {
            "workspaceId": "EXTENSION_PARAMETERS_REPLACE"
        },        
        "protectedSettings": {
            "workspaceKey": "EXTENSION_PARAMETERS_REPLACE"
        },
        "publisher": "Microsoft.EnterpriseCloud.Monitoring",
        "type": "OmsAgentForLinux",
        "typeHandlerVersion": "1.0"
    }
}
